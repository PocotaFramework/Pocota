<Window x:Class="Net.Leksi.Pocota.Client.ViewTracedPoco"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:Net.Leksi.Pocota.Client"
        xmlns:local1="clr-namespace:Net.Leksi.Pocota.Client;assembly=Net.Leksi.Pocota.Client.CSharp"
        mc:Ignorable="d"
        Title="ViewTracedPoco" Height="450" Width="800"  DataContext="{Binding RelativeSource={RelativeSource Self}}">
    <Window.Resources>
        <local1:BindingProxy x:Key="ViewTracedPocoCommandProxy" Data="{Binding Path=ViewTracedPocoCommand, Mode=OneWay}"/>
        <local1:BindingProxy x:Key="Util" Data="{Binding Path=Util, Mode=OneWay}"/>
    </Window.Resources>
    <DockPanel LastChildFill="True">
        <DataGrid ItemsSource="{Binding CollectionViewSource.View}" AutoGenerateColumns="False">
            <DataGrid.Resources>
                <DataTemplate x:Key="Initial">
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="{Binding Item2, Converter={local:PropertyValueConverter}, ConverterParameter={StaticResource Util}}" 
                                   Visibility="{Binding  Item2, Converter={local:PropertyValueConverter}, ConverterParameter=Text}"/>
                        <Button Command="{Binding Data, Source={StaticResource ViewTracedPocoCommandProxy}}" CommandParameter="{Binding Item2}" Margin="10,0,0,0"
                                Visibility="{Binding  Item2, Converter={local:PropertyValueConverter}}">
                            <Button.Content>Просмотр</Button.Content>
                        </Button>
                    </StackPanel>
                </DataTemplate>
                <DataTemplate x:Key="Current">
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="{Binding Item3, Converter={local:PropertyValueConverter}, ConverterParameter={StaticResource Util}}" 
                                   Visibility="{Binding  Item3, Converter={local:PropertyValueConverter}, ConverterParameter=Text}"/>
                        <Button Command="{Binding Data, Source={StaticResource ViewTracedPocoCommandProxy}}" CommandParameter="{Binding Item3}" Margin="10,0,0,0"
                                Visibility="{Binding  Item3, Converter={local:PropertyValueConverter}}">
                            <Button.Content>Просмотр</Button.Content>
                        </Button>
                    </StackPanel>
                </DataTemplate>
            </DataGrid.Resources>
            <DataGrid.Columns>
                <DataGridTextColumn Header="Свойство" Binding="{Binding Item1}"/>
                <DataGridTemplateColumn Header="Исходное значение" CellTemplate="{StaticResource Initial}"/>
                <DataGridTemplateColumn Header="Текущее значение" CellTemplate="{StaticResource Current}"/>
            </DataGrid.Columns>
        </DataGrid>
    </DockPanel>
</Window>
