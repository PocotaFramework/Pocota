<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:local="clr-namespace:Net.Leksi.Pocota.Client"
        xmlns:local1="clr-namespace:Net.Leksi.Pocota.Client;assembly=Net.Leksi.Pocota.Client.CSharp"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        mc:Ignorable="d"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
    <Style TargetType="Button" x:Key="ViewButtonStyle" x:Shared="False">
        <Style.Triggers>
            <DataTrigger Value="False">
                <DataTrigger.Binding>
                    <MultiBinding Converter="{local:ViewTracedPocoConverter}" ConverterParameter="$test">
                        <Binding Path="."/>
                        <Binding Path="$path"/>
                    </MultiBinding>
                </DataTrigger.Binding>
                <Setter Property="Visibility" Value="Collapsed"/>
            </DataTrigger>
        </Style.Triggers>
    </Style>
    <Style TargetType="TextBlock" x:Key="ModifiedPropertyStyle" x:Shared="False">
        <Style.Triggers>
            <DataTrigger Binding="{Binding IsModified}" Value="True">
                <Setter Property="Background" Value="#EADDCA"/>
            </DataTrigger>
        </Style.Triggers>
    </Style>
    <Style TargetType="ComboBox" x:Key="ViewCollectionComboBoxStyle" x:Shared="False">
        <Style.Triggers>
            <DataTrigger Binding="{Binding $path, Converter={local:ViewTracedPocoConverter}, ConverterParameter=IsNull}" Value="True">
                <Setter Property="Visibility" Value="Collapsed"/>
            </DataTrigger>
        </Style.Triggers>
    </Style>
    <Style TargetType="TextBlock" x:Key="ViewTextStyle" x:Shared="False">
        <Style.Triggers>
            <DataTrigger Binding="{Binding $path, Converter={local:ViewTracedPocoConverter}, ConverterParameter=$test}" Value="True">
                <Setter Property="Visibility" Value="Collapsed"/>
            </DataTrigger>
        </Style.Triggers>
    </Style>
    <Style TargetType="StackPanel" x:Key="PrimaryKeyStyle" x:Shared="False">
        <Style.Triggers>
            <DataTrigger Binding="{Binding IsEntity}" Value="False">
                <Setter Property="Visibility" Value="Collapsed"/>
            </DataTrigger>
        </Style.Triggers>
    </Style>
    <DataTemplate x:Key="ViewCollectionDataTemplate" x:Shared="False">
        <StackPanel>
            <TextBlock Style="{local1:ParameterizedResource ViewTextStyle, Replaces=$test:IsNotNull}">null</TextBlock>
            <ComboBox d:ItemsSource="{Binding $path, Converter={local:ViewTracedPocoConverter}}" 
                        SelectedIndex="0" 
                        Style="{local1:ParameterizedResource $ViewCollectionComboBoxStyle, 
                            Defaults=$ViewCollectionComboBoxStyle:ViewCollectionComboBoxStyle}">
                <ComboBox.ItemTemplate>
                    <DataTemplate>
                        <DockPanel LastChildFill="True">
                            <Button DockPanel.Dock="Right" Style="{local1:ParameterizedResource ViewButtonStyle, Replaces=$path:.|$test:IsPoco}" 
                                    Command="{Binding Data, Source={local1:ParameterizedResource $ViewTracedPocoCommandProxy}}" 
                                    CommandParameter="{Binding}" Margin="10,0,0,0">
                                <Button.Content>👁</Button.Content>
                            </Button>
                            <TextBlock Text="{Binding Converter={local:ViewTracedPocoConverter}}"/>
                        </DockPanel>
                    </DataTemplate>
                </ComboBox.ItemTemplate>
            </ComboBox>
        </StackPanel>
    </DataTemplate>
    <DataTemplate x:Key="ViewPocoDataTemplate" x:Shared="False">
        <DockPanel LastChildFill="True">
            <Button DockPanel.Dock="Right" Style="{local1:ParameterizedResource ViewButtonStyle, Replaces=$test:IsNotNull}"  Margin="10,0,0,0"
                    Command="{Binding Data, Source={local1:ParameterizedResource $ViewTracedPocoCommandProxy}}" 
                    CommandParameter="{Binding $path}">
                <Button.Content>👁</Button.Content>
            </Button>
            <TextBlock Text="{Binding $path, Converter={local:ViewTracedPocoConverter}}" />
        </DockPanel>
    </DataTemplate>
    <DataTemplate x:Key="ViewValueDataTemplate" x:Shared="False">
        <TextBlock Text="{Binding $path, Converter={local:ViewTracedPocoConverter}}" >
        </TextBlock>
    </DataTemplate>
    <local:ViewTracedPocoDataTemplateSelector x:Key="ViewTracedPocoDataTemplateSelector" x:Shared="False" 
                            Collection="{local1:ParameterizedResource ViewCollectionDataTemplate}"
                            Poco="{local1:ParameterizedResource ViewPocoDataTemplate}"
                            Value="{local1:ParameterizedResource ViewValueDataTemplate}"/>
    <local:ViewTracedPocoDataTemplateSelector x:Key="EditTracedPocoDataTemplateSelector" x:Shared="False" >
        <local:ViewTracedPocoDataTemplateSelector.Poco>
            <DataTemplate>
                <DockPanel LastChildFill="True">
                    <Button DockPanel.Dock="Right" Style="{local1:ParameterizedResource ViewButtonStyle, Replaces=$test:IsNotNull}" 
                                        Command="{Binding Data, Source={local1:ParameterizedResource $ViewTracedPocoCommandProxy}}" 
                                        CommandParameter="{Binding $path}">
                        <Button.Content>👁</Button.Content>
                    </Button>
                    <Button DockPanel.Dock="Right" Style="{local1:ParameterizedResource ViewButtonStyle, Replaces=$test:IsNullAndWritable}" 
                                        Command="{Binding Data, Source={local1:ParameterizedResource $AddNewPocoPropertyCommandProxy}}" 
                                        CommandParameter="{Binding}">
                        <Button.Content>➕</Button.Content>
                        <Button.ToolTip>Присвоить</Button.ToolTip>
                    </Button>
                    <Button DockPanel.Dock="Right" Style="{local1:ParameterizedResource ViewButtonStyle, Replaces=$test:IsNotNullAndWritable}" 
                                        Command="{Binding Data, Source={local1:ParameterizedResource $ClearPocoPropertyCommandProxy}}" 
                                        CommandParameter="{Binding}"
                                        Margin="10,0,0,0">
                        <Button.Content>➖</Button.Content>
                        <Button.ToolTip>Обнулить</Button.ToolTip>
                    </Button>
                    <TextBlock Text="{Binding $path, Converter={local:ViewTracedPocoConverter}}"/>
                </DockPanel>
            </DataTemplate>
        </local:ViewTracedPocoDataTemplateSelector.Poco>
        <local:ViewTracedPocoDataTemplateSelector.Value>
            <DataTemplate>
                <TextBox Text="{Binding $path, Converter={local:ViewTracedPocoConverter}, Mode=TwoWay}" HorizontalAlignment="Stretch">
                </TextBox>
            </DataTemplate>
        </local:ViewTracedPocoDataTemplateSelector.Value>
    </local:ViewTracedPocoDataTemplateSelector>

</ResourceDictionary>